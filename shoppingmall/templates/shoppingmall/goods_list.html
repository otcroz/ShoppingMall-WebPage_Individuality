{% extends 'shoppingmall/base.html' %}
{% block main_area %}

{% if user.is_authenticated %}
    {% if user.is_staff or user.is_superuser %}
        <a class="btn btn-info btn-small float-right" href="/goods/create_post">
            <i class="fas fa-pen"></i> New Post
        </a>  <!--New Post를 보여줌-->
    {% endif %}
{% endif %}

<h1>
    ALL GOODS
    {% if search_info %} <span class="badge badge-secondary">{{ search_info }}</span> {% endif %}
    {% if manufacturer %} <span class="badge badge-secondary">{{manufacturer}}</span> {% endif %}
    {% if case_type %} <span class="badge badge-secondary">{{case_type}}</span> {% endif %}
    {% if tag %} <i class="fas fa-tags"></i><span class="badge bg-light">{{ tag }}({{tag.post_set.count}})</span>{% endif %}
</h1>
{% if goods_list.exists %}
    <div class="row">
{% for p in goods_list %} <!--post_list 대신 object_list 사용해도 됨 / 모델명_list-->
    <!-- Blog post--> <!--포스트 전체 목록 생성, 최신순-->

        <div class="card mb-4 col-lg-4" id="goods-{{p.pk}}">
            <a class="text-decoration-none text-dark" href="{{ p.get_absolute_url }}">
            {% if p.image %}
                <img class="card-img-top" src="{{ p.image.url }}" alt="{{ p }}의 image" /><!--실제로는 업로드한 이미지가 보여짐-->
            {% else %}
                <img class="card-img-top" src="https://picsum.photos/seed/{{p.id}}/800/200" alt="random image" /> <!--p.id로 고유한 값을 줌, 아이디에 대한 이미지 고정-->
            {% endif %}
            <div class="card-body">
                {% if p.manufacturer %} <!--조건: 카테고리-->
                    <span class="badge badge-secondary">{{p.manufacturer}}</span>  <!--float-right: 오른쪽에 배치-->
                {% else %}
                    <span class="badge badge-secondary">OTHER THINGS</span>
                {% endif %}
                    <h3 class="card-title h5">{{ p.name | upper }}</h3> <!--템플릿 필터: 대문자로 보이게 / lower : 소문자-->
                {% if p.price %}
                    <h6 class="text-muted float-bottm">{{ p.price }} won</h6> <!--text-muted : 회색-->
                {% endif %}
                <p class="card-text">{{ p.get_content_markdown | truncatewords_html:50 | safe }}</p> <!--truncatewords:45 : 45개 단어 출력-->
            </div>
            </a>
        </div>
{% endfor %}
    </div>
{% else %} <!--post_list가 존재하지 않을 때-->
    <h2>아직 게시물이 없습니다.</h2>
{% endif %}

<!-- Pagination -->
<hr class="my-0" />
{% if is_paginated %}

<ul class="pagination justify-content-center my-4">
    {% if page_obj.has_previous %}
    <li class="page-item">
        <a class="page-link" href="?page={{page_obj.previous_page_number}}" tabindex="-1" aria-disabled="true">&larr; Newer</a>
    </li>
    {% else %}
    <li class="page-item disabled">
        <a class="page-link" href="#" tabindex="-1" aria-disabled="true">&larr; Newer</a>
    </li>
    {% endif %}
    {% if page_obj.has_next %}
    <li class="page-item">
        <a class="page-link" href="?page={{page_obj.next_page_number}}">Older &rarr;</a>
    </li>
    {% else %}
    <li class="page-item disabled">
        <a class="page-link" href="#!">Older &rarr;</a>
    </li>
    {% endif %}
</ul>
{% endif %}
</div>
{% endblock %}